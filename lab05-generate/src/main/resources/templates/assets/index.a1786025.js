import{s as S,h as c,i as te,r as u,o as $,j as Q,w as a,b as M,d as e,f as _,u as t,k as P,l as z,v as H,m as J,n as ae,q as fe,x as be,y as ge,z as X,a as Z,A as _e,t as ee,F as he,B as ve,C as ye}from"./index.7c8a6e16.js";function Ne(m){return S({headers:{datasource:localStorage.getItem("dataName")},url:"/tool/gen/list",method:"get",params:m})}function we(m){return S({headers:{datasource:localStorage.getItem("dataName")},url:"/tool/gen/db/list",method:"get",params:m})}function Ce(m){return S({headers:{datasource:localStorage.getItem("dataName")},url:"/tool/gen/importTable",method:"post",params:m})}function Se(m){return S({headers:{datasource:localStorage.getItem("dataName")},url:"/tool/gen/preview/"+m,method:"get"})}function ke(m){return S({headers:{datasource:localStorage.getItem("dataName")},url:"/tool/gen/"+m,method:"delete"})}function Ve(m){return S({headers:{datasource:localStorage.getItem("dataName")},url:"/tool/gen/genCode/"+m,method:"get"})}function xe(m){return S({headers:{datasource:localStorage.getItem("dataName")},url:"/tool/gen/synchDb/"+m,method:"get"})}const Te={class:"dialog-footer"},Ie={__name:"importTable",emits:["ok"],setup(m,{expose:E,emit:s}){const k=c(0),h=c(!1),N=c([]),V=c([]),{proxy:w}=ae(),p=te({pageNum:1,pageSize:10,tableName:void 0,tableComment:void 0});function R(){x(),h.value=!0}function F(d){w.$refs.table.toggleRowSelection(d)}function v(d){N.value=d.map(r=>r.tableName)}function x(){we(p).then(d=>{V.value=d.rows,k.value=d.total})}function T(){p.pageNum=1,x()}function i(){w.resetForm("queryRef"),T()}function f(){const d=N.value.join(",");if(d==""){w.$modal.msgError("\u8BF7\u9009\u62E9\u8981\u5BFC\u5165\u7684\u8868");return}Ce({tables:d}).then(r=>{w.$modal.msgSuccess(r.msg),r.code===200&&(h.value=!1,s("ok"))})}return E({show:R}),(d,r)=>{const D=u("el-input"),U=u("el-form-item"),I=u("el-button"),Y=u("el-form"),C=u("el-table-column"),G=u("el-table"),A=u("pagination"),O=u("el-row"),j=u("el-dialog");return $(),Q(j,{title:"\u5BFC\u5165\u8868",modelValue:t(h),"onUpdate:modelValue":r[5]||(r[5]=l=>J(h)?h.value=l:null),width:"800px",top:"5vh","append-to-body":""},{footer:a(()=>[M("div",Te,[e(I,{type:"primary",onClick:f},{default:a(()=>[_("\u786E \u5B9A")]),_:1}),e(I,{onClick:r[4]||(r[4]=l=>h.value=!1)},{default:a(()=>[_("\u53D6 \u6D88")]),_:1})])]),default:a(()=>[e(Y,{model:t(p),ref:"queryRef",inline:!0},{default:a(()=>[e(U,{label:"\u8868\u540D\u79F0",prop:"tableName"},{default:a(()=>[e(D,{modelValue:t(p).tableName,"onUpdate:modelValue":r[0]||(r[0]=l=>t(p).tableName=l),placeholder:"\u8BF7\u8F93\u5165\u8868\u540D\u79F0",clearable:"",onKeyup:P(T,["enter"])},null,8,["modelValue","onKeyup"])]),_:1}),e(U,{label:"\u8868\u63CF\u8FF0",prop:"tableComment"},{default:a(()=>[e(D,{modelValue:t(p).tableComment,"onUpdate:modelValue":r[1]||(r[1]=l=>t(p).tableComment=l),placeholder:"\u8BF7\u8F93\u5165\u8868\u63CF\u8FF0",clearable:"",onKeyup:P(T,["enter"])},null,8,["modelValue","onKeyup"])]),_:1}),e(U,null,{default:a(()=>[e(I,{type:"primary",icon:"Search",onClick:T},{default:a(()=>[_("\u641C\u7D22")]),_:1}),e(I,{icon:"Refresh",onClick:i},{default:a(()=>[_("\u91CD\u7F6E")]),_:1})]),_:1})]),_:1},8,["model"]),e(O,null,{default:a(()=>[e(G,{onRowClick:F,ref:"table",data:t(V),onSelectionChange:v,height:"260px"},{default:a(()=>[e(C,{type:"selection",width:"55"}),e(C,{prop:"tableName",label:"\u8868\u540D\u79F0","show-overflow-tooltip":!0}),e(C,{prop:"tableComment",label:"\u8868\u63CF\u8FF0","show-overflow-tooltip":!0}),e(C,{prop:"createTime",label:"\u521B\u5EFA\u65F6\u95F4"}),e(C,{prop:"updateTime",label:"\u66F4\u65B0\u65F6\u95F4"})]),_:1},8,["data"]),z(e(A,{total:t(k),page:t(p).pageNum,"onUpdate:page":r[2]||(r[2]=l=>t(p).pageNum=l),limit:t(p).pageSize,"onUpdate:limit":r[3]||(r[3]=l=>t(p).pageSize=l),onPagination:x},null,8,["total","page","limit"]),[[H,t(k)>0]])]),_:1})]),_:1},8,["modelValue"])}}},$e={class:"app-container"},Re=fe({name:"Gen"}),Ue=Object.assign(Re,{setup(m){const E=_e(),{proxy:s}=ae(),k=c([]),h=c(!0),N=c(!0),V=c([]),w=c(!0),p=c(!0),R=c(0),F=c([]),v=c([]),x=c(""),T=te({queryParams:{pageNum:1,pageSize:10,tableName:void 0,tableComment:void 0,dataName:"master"},preview:{open:!1,title:"\u4EE3\u7801\u9884\u89C8",data:{},activeName:"domain.java"}}),{queryParams:i,preview:f}=be(T);localStorage.setItem("dataName",i.value.dataName),ge(()=>{const l=E.query.t;l!=null&&l!=x.value&&(x.value=l,i.value.pageNum=Number(E.query.pageNum),v.value=[],s.resetForm("queryForm"),d())});function d(){h.value=!0,Ne(s.addDateRange(i.value,v.value)).then(l=>{k.value=l.rows,R.value=l.total,h.value=!1})}function r(){localStorage.setItem("dataName",i.value.dataName),i.value.pageNum=1,d()}function D(l){const o=l.tableName||F.value;if(o==""){s.$modal.msgError("\u8BF7\u9009\u62E9\u8981\u751F\u6210\u7684\u6570\u636E");return}l.genType==="1"?Ve(l.tableName).then(B=>{s.$modal.msgSuccess("\u6210\u529F\u751F\u6210\u5230\u81EA\u5B9A\u4E49\u8DEF\u5F84\uFF1A"+l.genPath)}):s.$download.zip("/tool/gen/batchGenCode?tables="+o,"ruoyi.zip")}function U(l){const o=l.tableName;s.$modal.confirm('\u786E\u8BA4\u8981\u5F3A\u5236\u540C\u6B65"'+o+'"\u8868\u7ED3\u6784\u5417\uFF1F').then(function(){return xe(o)}).then(()=>{s.$modal.msgSuccess("\u540C\u6B65\u6210\u529F")}).catch(()=>{})}function I(){s.$refs.importRef.show()}function Y(){v.value=[],s.resetForm("queryRef"),r()}function C(l){Se(l.tableId).then(o=>{f.value.data=o.data,f.value.open=!0,f.value.activeName="domain.java"})}function G(){s.$modal.msgSuccess("\u590D\u5236\u6210\u529F")}function A(l){V.value=l.map(o=>o.tableId),F.value=l.map(o=>o.tableName),w.value=l.length!=1,p.value=!l.length}function O(l){const o=l.tableId||V.value[0];ye.push({path:"/tool/gen-edit/index/"+o,query:{pageNum:i.value.pageNum}})}function j(l){const o=l.tableId||V.value;s.$modal.confirm('\u662F\u5426\u786E\u8BA4\u5220\u9664\u8868\u7F16\u53F7\u4E3A"'+o+'"\u7684\u6570\u636E\u9879\uFF1F').then(function(){return ke(o)}).then(()=>{d(),s.$modal.msgSuccess("\u5220\u9664\u6210\u529F")}).catch(()=>{})}return d(),(l,o)=>{const B=u("el-input"),q=u("el-form-item"),le=u("el-date-picker"),b=u("el-button"),oe=u("el-form"),L=u("el-col"),ne=u("right-toolbar"),ue=u("el-row"),y=u("el-table-column"),K=u("el-tooltip"),re=u("el-table"),ie=u("pagination"),de=u("el-link"),me=u("el-tab-pane"),se=u("el-tabs"),pe=u("el-dialog"),ce=X("loading"),W=X("copyText");return $(),Z("div",$e,[z(e(oe,{model:t(i),ref:"queryRef",inline:!0},{default:a(()=>[e(q,{label:"\u6570\u636E\u6E90",prop:"dataName"},{default:a(()=>[e(B,{modelValue:t(i).dataName,"onUpdate:modelValue":o[0]||(o[0]=n=>t(i).dataName=n),placeholder:"\u8BF7\u8F93\u5165\u6570\u636E\u6E90\u540D\u79F0",clearable:"",style:{width:"200px"},onKeyup:P(r,["enter"])},null,8,["modelValue","onKeyup"])]),_:1}),e(q,{label:"\u8868\u540D\u79F0",prop:"tableName"},{default:a(()=>[e(B,{modelValue:t(i).tableName,"onUpdate:modelValue":o[1]||(o[1]=n=>t(i).tableName=n),placeholder:"\u8BF7\u8F93\u5165\u8868\u540D\u79F0",clearable:"",style:{width:"200px"},onKeyup:P(r,["enter"])},null,8,["modelValue","onKeyup"])]),_:1}),e(q,{label:"\u8868\u63CF\u8FF0",prop:"tableComment"},{default:a(()=>[e(B,{modelValue:t(i).tableComment,"onUpdate:modelValue":o[2]||(o[2]=n=>t(i).tableComment=n),placeholder:"\u8BF7\u8F93\u5165\u8868\u63CF\u8FF0",clearable:"",style:{width:"200px"},onKeyup:P(r,["enter"])},null,8,["modelValue","onKeyup"])]),_:1}),e(q,{label:"\u521B\u5EFA\u65F6\u95F4",style:{width:"308px"}},{default:a(()=>[e(le,{modelValue:t(v),"onUpdate:modelValue":o[3]||(o[3]=n=>J(v)?v.value=n:null),"value-format":"YYYY-MM-DD",type:"daterange","range-separator":"-","start-placeholder":"\u5F00\u59CB\u65E5\u671F","end-placeholder":"\u7ED3\u675F\u65E5\u671F"},null,8,["modelValue"])]),_:1}),e(q,null,{default:a(()=>[e(b,{type:"primary",icon:"Search",onClick:r},{default:a(()=>[_("\u641C\u7D22")]),_:1}),e(b,{icon:"Refresh",onClick:Y},{default:a(()=>[_("\u91CD\u7F6E")]),_:1})]),_:1})]),_:1},8,["model"]),[[H,t(N)]]),e(ue,{gutter:10,class:"mb8"},{default:a(()=>[e(L,{span:1.5},{default:a(()=>[e(b,{type:"primary",plain:"",icon:"Download",onClick:D},{default:a(()=>[_("\u751F\u6210")]),_:1})]),_:1},8,["span"]),e(L,{span:1.5},{default:a(()=>[e(b,{type:"info",plain:"",icon:"Upload",onClick:I},{default:a(()=>[_("\u5BFC\u5165")]),_:1})]),_:1},8,["span"]),e(L,{span:1.5},{default:a(()=>[e(b,{type:"success",plain:"",icon:"Edit",disabled:t(w),onClick:O},{default:a(()=>[_("\u4FEE\u6539")]),_:1},8,["disabled"])]),_:1},8,["span"]),e(L,{span:1.5},{default:a(()=>[e(b,{type:"danger",plain:"",icon:"Delete",disabled:t(p),onClick:j},{default:a(()=>[_("\u5220\u9664")]),_:1},8,["disabled"])]),_:1},8,["span"]),e(ne,{showSearch:t(N),"onUpdate:showSearch":o[4]||(o[4]=n=>J(N)?N.value=n:null),onQueryTable:d},null,8,["showSearch"])]),_:1}),z(($(),Q(re,{data:t(k),onSelectionChange:A},{default:a(()=>[e(y,{type:"selection",align:"center",width:"55"}),e(y,{label:"\u5E8F\u53F7",type:"index",width:"50",align:"center"},{default:a(n=>[M("span",null,ee((t(i).pageNum-1)*t(i).pageSize+n.$index+1),1)]),_:1}),e(y,{label:"\u8868\u540D\u79F0",align:"center",prop:"tableName","show-overflow-tooltip":!0}),e(y,{label:"\u8868\u63CF\u8FF0",align:"center",prop:"tableComment","show-overflow-tooltip":!0}),e(y,{label:"\u5B9E\u4F53",align:"center",prop:"className","show-overflow-tooltip":!0}),e(y,{label:"\u521B\u5EFA\u65F6\u95F4",align:"center",prop:"createTime",width:"160"}),e(y,{label:"\u66F4\u65B0\u65F6\u95F4",align:"center",prop:"updateTime",width:"160"}),e(y,{label:"\u64CD\u4F5C",align:"center",width:"330","class-name":"small-padding fixed-width"},{default:a(n=>[e(K,{content:"\u9884\u89C8",placement:"top"},{default:a(()=>[e(b,{link:"",type:"primary",icon:"View",onClick:g=>C(n.row)},null,8,["onClick"])]),_:2},1024),e(K,{content:"\u7F16\u8F91",placement:"top"},{default:a(()=>[e(b,{link:"",type:"primary",icon:"Edit",onClick:g=>O(n.row)},null,8,["onClick"])]),_:2},1024),e(K,{content:"\u5220\u9664",placement:"top"},{default:a(()=>[e(b,{link:"",type:"primary",icon:"Delete",onClick:g=>j(n.row)},null,8,["onClick"])]),_:2},1024),e(K,{content:"\u540C\u6B65",placement:"top"},{default:a(()=>[e(b,{link:"",type:"primary",icon:"Refresh",onClick:g=>U(n.row)},null,8,["onClick"])]),_:2},1024),e(K,{content:"\u751F\u6210\u4EE3\u7801",placement:"top"},{default:a(()=>[e(b,{link:"",type:"primary",icon:"Download",onClick:g=>D(n.row)},null,8,["onClick"])]),_:2},1024)]),_:1})]),_:1},8,["data"])),[[ce,t(h)]]),z(e(ie,{total:t(R),page:t(i).pageNum,"onUpdate:page":o[5]||(o[5]=n=>t(i).pageNum=n),limit:t(i).pageSize,"onUpdate:limit":o[6]||(o[6]=n=>t(i).pageSize=n),onPagination:d},null,8,["total","page","limit"]),[[H,t(R)>0]]),e(pe,{title:t(f).title,modelValue:t(f).open,"onUpdate:modelValue":o[8]||(o[8]=n=>t(f).open=n),width:"80%",top:"5vh","append-to-body":"",class:"scrollbar"},{default:a(()=>[e(se,{modelValue:t(f).activeName,"onUpdate:modelValue":o[7]||(o[7]=n=>t(f).activeName=n)},{default:a(()=>[($(!0),Z(he,null,ve(t(f).data,(n,g)=>($(),Q(me,{label:g.substring(g.lastIndexOf("/")+1,g.indexOf(".vm")),name:g.substring(g.lastIndexOf("/")+1,g.indexOf(".vm")),key:n},{default:a(()=>[z(($(),Q(de,{underline:!1,icon:"DocumentCopy",style:{float:"right"}},{default:a(()=>[_("\xA0\u590D\u5236")]),_:2},1024)),[[W,n],[W,G,"callback"]]),M("pre",null,ee(n),1)]),_:2},1032,["label","name"]))),128))]),_:1},8,["modelValue"])]),_:1},8,["title","modelValue"]),e(t(Ie),{ref:"importRef",onOk:r},null,512)])}}});export{Ue as default};
